<!-- $Id$ -->
<autobuild>
    <configuration>
        <environment name="ACE_ROOT"     value="C:/projects/ace_cvs/ACE_wrappers" />
        <environment name="TAO_ROOT"     value="c:/projects/ace_cvs/ACE_wrappers/TAO"/>
        <environment name="PATH"         value="C:/projects/ace_cvs/ACE_wrappers/lib;C:/projects/ace_cvs/ACE_wrappers/bin;c:/projects/gmaxey~1.3/nscorba/tools/g06.24/bin;c:/tools/cvs" type="prefix" />
        <environment name="CVSROOT"  value=":ext:cvs:/project/cvs-repository" />
        <environment name="MPC_ROOT" value="C:\projects\ace_cvs\MPC" />

        <environment name="COMP_ROOT" value="c:/projects/gmaxey_c20.3/NSCORBA/tools/G06.24" />

        <environment name="NSC_ROOT" value="C:/projects/ace_cvs/NSC" />

        <variable name="root"            value="C:\projects\ace_cvs" />
        <variable name="project_root"    value="C:/projects/ace_cvs/ACE_wrappers" />
	<variable name="log_file"        value="build_log.txt" />
        <variable name="log_root"        value="c:\projects\ace_cvs\build_logs\" />
        <variable name="name"            value="HP NSK" />
        <variable name="configs"         value="unknown" />
    </configuration>

    <command name="status"            options="on" />
    <command name="file_manipulation" options="type=mustnotexist file=ACE_wrappers/.disable" />
    <command name="file_manipulation" options="type=create file=ACE_wrappers/.disable output='RUNNING'" />

    <command name="log"               options="ON" />

    <!-- Remove any previously generated object files, dlls, etc. -->
    <command name="win32make"         options="msvc_mpc_auto_compile -vc7 -TAO -Debug -clean" />

    <!-- Remove any previously generated Microsoft projects and solutions -->
    <command name="shell"             options="del /s *.vcproj > nul" />
    <command name="shell"             options="del /s *.sln > nul" />

    <!-- Remove any previously generated Makefiles -->
    <command name="shell"             options="del /s GNUmakefile* > nul" />


    <command name="cvs"               options="checkout -P ACE_wrappers" />
    <command name="cvs"               options="checkout -P MPC" />

    <!-- ############################################################ -->
    <!-- Build Windows based TAO IDL compiler for cross compiles.     -->
    <!-- ############################################################ -->

    <command name="file_manipulation" options="type=create file=ACE_wrappers/ace/config.h output='#define ACE_DISABLE_WIN32_ERROR_WINDOWS\n#define ACE_HAS_STANDARD_CPP_LIBRARY 1\n#include \x22ace/config-win32.h\x22\n'" />

    <command name="generate_workspace" options="dirs=ace -type vc71"/>
    <command name="generate_workspace" options="dirs=apps -type vc71 -exclude JAWS,JAWS3,Gateway,gperf/tests,soreduce,drwho,mkcsregdb"/>
    <command name="generate_workspace" options="dirs=TAO/TAO_IDL -type vc71"/>

    <command name="win32make"         options="msvc_mpc_auto_compile -vc7 -TAO -Debug" />

    <!-- ############################################################ -->
    <!-- Build ACE + TAO for NSK using cross compiler.                -->
    <!-- ############################################################ -->

    <command name="file_manipulation" options="type=create file=ACE_wrappers/ace/config.h output='#include \x22ace/config-tandem-nsk-mips-v3.h\x22\n'" />
    <command name="file_manipulation" options="type=create file=ACE_wrappers/include/makeinclude/platform_macros.GNU output='include $(ACE_ROOT)/include/makeinclude/platform_nsk.GNU\n'" />
    <command name="file_manipulation" options="type=create file=ACE_wrappers/bin/MakeProjectCreator/config/default.features output='srl=1\nnscorba=1\nami=0\nrt_corba=0\n'" /> 
    <command name="file_manipulation" options="type=create file=ACE_wrappers/bin/MakeProjectCreator/config/srl_component.mpb output='feature(srl) {\n  staticflags += _SRL\n  libout = $(NSC_ROOT)/nscsrl\n  verbatim(gnuace, macros) {\n    CODE_GEN=-Wsrl\n  }\n}\n'" /> 

    <command name="print_os_version" />
    <command name="check_compiler" options="c89" />
    <command name="print_ace_config" />
    <command name="print_make_version" />
    <command name="print_perl_version" />

    <!-- Uses ACE.mwc -->
    <command name="generate_workspace" options="-static -exclude TAO,Kokyu,examples,ASNMP,performance-tests,apps,APG,netsvcs,websvcs,tests,protocol" />
    <!-- Uses TAO/TAO.mwc -->
    <command name="generate_workspace" options="dirs=TAO -static -exclude TAOACE.mwc,CIAO,examples,interop-tests,performance-tests,tests,orbsvcs,docs,tao/BiDir_GIOP.mpc,tao/Domain.mpc,tao/ImR_Client.mpc,tao/SmartProxies.mpc,tao/Strategies.mpc" />
    <!-- TAO tests, exclude those inappopriate for the platform -->
    <command name="generate_workspace" options="dirs=TAO/tests -exclude AMH_Exceptions,AMH_Oneway,BiDirectional,BiDirectional_NestedUpcall,Bug_1476_Regression,Bug_1495_Regression,Bug_1639_Regression,Bug_1904_Regression,CodeSets,Collocation,Connection_Purging,DLL_ORB,Leader_Followers,MT_BiDir,Nested_Event_Loop,Object_Loader,Smart_Proxies,Strategies,UNKNOWN_Exception" />
    <!-- For NSK shared runtime library (SRL) -->
    <command name="generate_workspace" options="dirs=../nsc/nscsrl -template %NSC_ROOT%/nscsrl/gnusrl.mpd -ti lib:gnusrl " />

    <command name="make"              options="-k realclean" />
    <command name="make"              options="-k -C TAO realclean" />
    <command name="make"              options="-k -C TAO/tests realclean" />
    <command name="make"              options="-k -C ../NSC/nscsrl realclean" />
    <command name="make"              options="-C ace" />
    <command name="make"              options="-C ACEXML/common" />
    <command name="make"              options="-C ACEXML/parser" />
    <command name="make"              options="-C ACEXML/apps/svcconf" />
    <command name="make"              options="-C TAO/tao" />
    <command name="make"              options="-C ../nsc/nscsrl" />
    <command name="make"              options="-C TAO/TAO_IDL" />
    <command name="make"              options="-k -C TAO/tests" />

    <!-- Need to develop capability of running tests cross platform -->
    <!-- command name="auto_run_tests"    options="-a" / -->

    <command name="log"               options="OFF" />
    <command name="process_logs"      options="move prettify clean=5 index" />
    <command name="file_manipulation" options="type=delete file=ACE_wrappers/.disable" />
    <command name="shell"             options="c:\tools\Putty\pscp -batch c:\projects\ace_cvs\build_logs\* bczar@naboo.dre.vanderbilt.edu:/web/users/isisbuilds/auto_compile_logs/tao_hp_nsk" />

    <command name="status"            options="off" />
</autobuild>
